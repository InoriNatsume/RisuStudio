# RisuStudio ìµœì¢… ì‚¬ì–‘ì„œ

> **ê°œë°œ ì§„í–‰ ìƒí™©ì€ [RisuStudio_Progress.md](RisuStudio_Progress.md)ì—ì„œ í™•ì¸í•˜ì„¸ìš”.**

---

## íŒŒì¼ í¬ë§·

> **ìƒì„¸ ì‚¬ì–‘ì€ [docs/](docs/) í´ë”ë¥¼ ì°¸ì¡°í•˜ì„¸ìš”.**
> - [charx.md](docs/charx.md) - ìºë¦­í„° ì¹´ë“œ (.charx, .png, .jpg)
> - [risum.md](docs/risum.md) - ëª¨ë“ˆ (.risum)
> - [risup.md](docs/risup.md) - í”„ë¦¬ì…‹ (.risup, .risupreset)
> - [gotchas.md](docs/gotchas.md) - íŒŒì‹± í•¨ì • ë° í•´ê²°ì±…

### ì§€ì› íŒŒì¼ ìš”ì•½

| í¬ë§· | í™•ì¥ì | ì„¤ëª… |
|------|--------|------|
| **ìºë¦­í„° ì¹´ë“œ** | `.charx` | ZIP ì•„ì¹´ì´ë¸Œ í˜•ì‹ |
| **ìºë¦­í„° ì¹´ë“œ** | `.jpg/.jpeg` | CharX-JPEG (JPEG + ZIP) |
| **ìºë¦­í„° ì¹´ë“œ** | `.png` | PNG tEXt ì²­í¬ |
| **ëª¨ë“ˆ** | `.risum` | RPack ì••ì¶• ë°”ì´ë„ˆë¦¬ |
| **í”„ë¦¬ì…‹** | `.risup` | RPack + fflate + AES-GCM |
| **í”„ë¦¬ì…‹** | `.risupreset` | fflate + AES-GCM (ë ˆê±°ì‹œ) |

---

## 1. í”„ë¡œì íŠ¸ ê°œìš”

### 1.1 ì •ì˜

**RisuStudio**ëŠ” RisuAI ìºë¦­í„° ì¹´ë“œ(.charx), ëª¨ë“ˆ(.risum), í”„ë¦¬ì…‹(.risup)ì„ ìœ„í•œ **í†µí•© ê°œë°œ ë° í…ŒìŠ¤íŠ¸ í™˜ê²½**ì…ë‹ˆë‹¤.

### 1.2 í•µì‹¬ ê°€ì¹˜

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  "RisuAI ìºë¦­í„° ì¹´ë“œ í¸ì§‘ì„ ìœ„í•œ ìˆœìˆ˜ ì—ë””í„°"                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                     â”‚
â”‚  1. íŒŒì¼ ì™„ì „ ì§€ì›                                                  â”‚
â”‚     â””â”€ .charx, .risum, .risup, .png/.jpg ìºë¦­í„° ì¹´ë“œ íŒŒì‹±/ì €ì¥       â”‚
â”‚                                                                     â”‚
â”‚  2. í¸ì§‘ê¸° (ëª¨ë“ˆ ë§¤ë‹ˆì € ê¸°ëŠ¥ í†µí•©)                                  â”‚
â”‚     â””â”€ ë¡œì–´ë¶/Regex/Trigger í¸ì§‘ + CBS í•˜ì´ë¼ì´íŠ¸                    â”‚
â”‚                                                                     â”‚
â”‚  3. ì—ì…‹ ê´€ë¦¬                                                        â”‚
â”‚     â””â”€ ê°¤ëŸ¬ë¦¬ ë·°, ë‹¤ìš´ë¡œë“œ, EXIF ë©”íƒ€ë°ì´í„° ë·°ì–´                     â”‚
â”‚                                                                     â”‚
â”‚  4. ìœ íš¨ì„± ê²€ì¦                                                      â”‚
â”‚     â””â”€ í¸ì§‘ ê²°ê³¼ë¬¼ì´ RisuAIì—ì„œ ë¡œë“œ ê°€ëŠ¥í•œì§€ ì‹¤ì‹œê°„ ê²€ì¦           â”‚
â”‚                                                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

> **ì°¸ê³ **: ì‹œë®¬ë ˆì´í„° ê¸°ëŠ¥ì€ ë³„ë„ í”„ë¡œì íŠ¸(risu-simulator)ë¡œ ë¶„ë¦¬ë¨

### 1.3 ê¸°ìˆ  ìŠ¤íƒ

| í•­ëª© | ì„ íƒ | ì´ìœ  |
|------|------|------|
| í”„ë ˆì„ì›Œí¬ | Svelte 4 + TypeScript | RisuAIì™€ ë™ì¼, ê°€ë³ê³  ë°˜ì‘í˜• |
| ë¹Œë“œ ë„êµ¬ | Vite | ë¹ ë¥¸ ê°œë°œ, ê°„ë‹¨í•œ ì„¤ì • |
| ë°°í¬ | GitHub Pages | ë¬´ë£Œ, ì½”ë“œì™€ í†µí•© ê´€ë¦¬ |
| ì½”ë“œ ì—ë””í„° | CodeMirror 6 | ëª¨ë“ˆë§¤ë‹ˆì €ì™€ ë™ì¼, CBS í•˜ì´ë¼ì´íŠ¸ |
| íŒŒì¼ ì²˜ë¦¬ | fflate, msgpackr | ZIP/MsgPack ì²˜ë¦¬ |

---

## 2. í™”ë©´ êµ¬ì¡°

### 2.1 ë©”ì¸ ë„¤ë¹„ê²Œì´ì…˜

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  RisuStudio                                                          [Ã—]   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  [ğŸ“ í¸ì§‘] [âš™ï¸ ì„¤ì •]                                                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚                         (ê° íƒ­ë³„ ì „ì²´ í™”ë©´ ì½˜í…ì¸ )                          â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2.2 í¸ì§‘ í™”ë©´

ëª¨ë“ˆë§¤ë‹ˆì € UIë¥¼ ê·¸ëŒ€ë¡œ ìœ ì§€í•˜ì—¬ ìµìˆ™í•¨ê³¼ ê²€ì¦ëœ UX ì œê³µ.

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  [ğŸ“ í¸ì§‘â—€] [âš™ï¸]                                                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  íŒŒì¼: [MyChar.charx â–¼]  [ğŸ“‚ ì—´ê¸°] [ğŸ’¾ ì €ì¥] [ğŸ“¤ ë‚´ë³´ë‚´ê¸°]                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  [ì •ë³´] [ë¡œì–´ë¶ (12)] [Regex (5)] [Trigger (3)] [ì—ì…‹] [ìŠ¤í¬ë¦½íŠ¸]          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚                                                                    â”‚    â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚    â”‚
â”‚  â”‚  â”‚             â”‚  â”‚                                              â”‚ â”‚    â”‚
â”‚  â”‚  â”‚  ë¶ë§ˆí¬     â”‚  â”‚  ì—ë””í„° (CodeMirror)                         â”‚ â”‚    â”‚
â”‚  â”‚  â”‚  íŒ¨ë„       â”‚  â”‚                                              â”‚ â”‚    â”‚
â”‚  â”‚  â”‚             â”‚  â”‚  â€¢ CBS êµ¬ë¬¸ ê°•ì¡°                             â”‚ â”‚    â”‚
â”‚  â”‚  â”‚  â€¢ í•­ëª© ëª©ë¡â”‚  â”‚  â€¢ ìë™ì™„ì„± (ì„ íƒì )                         â”‚ â”‚    â”‚
â”‚  â”‚  â”‚  â€¢ ê²€ìƒ‰     â”‚  â”‚  â€¢ ì¤„ë²ˆí˜¸                                    â”‚ â”‚    â”‚
â”‚  â”‚  â”‚  â€¢ í´ë”     â”‚  â”‚                                              â”‚ â”‚    â”‚
â”‚  â”‚  â”‚             â”‚  â”‚                                              â”‚ â”‚    â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚    â”‚
â”‚  â”‚                                                                    â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                             â”‚
â”‚  Footer: [ğŸ” ì „ì²´ ê²€ìƒ‰] [ğŸ’¾ ì €ì¥]                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### íŒŒì¼ íƒ€ì…ë³„ íƒ­ êµ¬ì„±

| íŒŒì¼ íƒ€ì… | íƒ­ êµ¬ì„± |
|----------|---------|
| .charx (ìºë¦­í„°) | ì •ë³´, ë¡œì–´ë¶, Regex, Trigger, ì—ì…‹, ìŠ¤í¬ë¦½íŠ¸ |
| .risum (ëª¨ë“ˆ) | ì •ë³´, ë¡œì–´ë¶, Regex, Trigger, ì—ì…‹ |
| .risup (í”„ë¦¬ì…‹) | ì •ë³´, í”„ë¡¬í”„íŠ¸ í…œí”Œë¦¿, Regex, íŒŒë¼ë¯¸í„° |

---

## 3. ê³µìœ  ìƒíƒœ (Store)

```typescript
// ë¡œë“œëœ íŒŒì¼ë“¤
loadedFiles: {
  character: CharacterCard | null,
  preset: RisuPreset | null,
  modules: RisuModule[]
}

// í˜„ì¬ í¸ì§‘ ì¤‘ì¸ íŒŒì¼
currentFile: {
  type: 'character' | 'preset' | 'module',
  index?: number,  // ëª¨ë“ˆì¸ ê²½ìš°
  data: any,
  hasChanges: boolean
}
```

---

## 4. ì•„í‚¤í…ì²˜

### 4.1 ë ˆì´ì–´ êµ¬ì¡°

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                           RisuStudio ì•„í‚¤í…ì²˜                               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                         UI Layer (Svelte)                           â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                          â”‚   â”‚
â”‚  â”‚  â”‚ Editor   â”‚ â”‚ Settings â”‚                                          â”‚   â”‚
â”‚  â”‚  â”‚ Screen   â”‚ â”‚  Screen  â”‚                                          â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜                                          â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚          â”‚            â”‚                                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                      Feature Layer (ì„œë¹„ìŠ¤)                          â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                   â”‚   â”‚
â”‚  â”‚  â”‚   Editor    â”‚  â”‚ Validation  â”‚                                   â”‚   â”‚
â”‚  â”‚  â”‚  Service    â”‚  â”‚   Service   â”‚                                   â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜                                   â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚            â”‚                â”‚                                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                         Core Layer (ìˆœìˆ˜ ë¡œì§)                       â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”                    â”‚   â”‚
â”‚  â”‚  â”‚ Parser  â”‚ â”‚ Types   â”‚ â”‚ Valid   â”‚ â”‚  EXIF   â”‚                    â”‚   â”‚
â”‚  â”‚  â”‚ (íŒŒì¼) â”‚ â”‚         â”‚ â”‚ ation   â”‚ â”‚ Extract â”‚                    â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                    â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 4.2 Core Layer ìƒì„¸

```typescript
// === Parser (íŒŒì¼ í¬ë§·) ===
interface IParser<T> {
  parse(data: ArrayBuffer): T;
  serialize(obj: T): ArrayBuffer;
}

const characterCardParser: IParser<CharacterCard>;
const risumParser: IParser<RisuModule>;
const risupParser: IParser<RisuPreset>;
const pngParser: IParser<CharacterCard>;  // tEXt ì²­í¬

// === Validation ===
interface ValidationResult {
  isValid: boolean;
  errors: ValidationError[];
  warnings: ValidationWarning[];
}

function validateCharacter(char: CharacterCard): ValidationResult;
function validateModule(module: RisuModule): ValidationResult;
function validatePreset(preset: RisuPreset): ValidationResult;

// === EXIF Extractor ===
function extractImageMetadata(data: ArrayBuffer): ExtractedMetadata;
function parseNAISteganography(data: ArrayBuffer): NAIMetadata;
function parseComfyUIWorkflow(data: ArrayBuffer): ComfyUIMetadata;
```

### 4.3 Feature Layer ìƒì„¸

```typescript
// === Editor Service ===
class EditorService {
  loadFile(file: File): Promise<EditableDocument>;
  saveFile(doc: EditableDocument): Promise<Blob>;
  
  // CRUD
  addLorebook(doc: CharacterCard, lore: Lorebook): void;
  updateLorebook(doc: CharacterCard, id: string, data: Partial<Lorebook>): void;
  deleteLorebook(doc: CharacterCard, id: string): void;
  
  addRegex(doc: HasRegex, regex: RegexScript): void;
  updateRegex(doc: HasRegex, index: number, data: Partial<RegexScript>): void;
  
  // ê²€ìƒ‰
  searchInDocument(doc: any, query: string): SearchResult[];
  replaceInDocument(doc: any, find: string, replace: string): ReplaceResult;
}

```

---

## 5. ê¸°ëŠ¥ ìƒì„¸

### 5.1 íŒŒì¼ ì§€ì›

| í¬ë§· | ì½ê¸° | ì“°ê¸° | ì˜ì¡´ì„± | ìš°ì„ ìˆœìœ„ |
|------|:----:|:----:|--------|:--------:|
| .charx (ìºë¦­í„° ì¹´ë“œ ZIP) | âœ… | âœ… | fflate | P0 |
| .risum (RPack) | âœ… | âœ… | ìˆœìˆ˜ JS | P0 |
| .risup (RPack+fflate+MsgPack+AES) | âœ… | P2 | fflate, msgpackr | P1 |
| .risupreset (fflate+MsgPack+AES) | âœ… | P3 | fflate, msgpackr | P1 |
| .png/.jpg ìºë¦­í„° | âœ… | P3 | ìˆœìˆ˜ JS | P2 |
| NAI/ST í”„ë¦¬ì…‹ ë³€í™˜ | âœ… | âŒ | - | P2 |

#### íŒŒì¼ ì²˜ë¦¬ ì²´ì¸ ìš”ì•½

```
.charx:  file â†’ fflate.unzip â†’ card.json + assets/
.risum:  file â†’ [Magic+Ver] â†’ RPackí•´ì œ â†’ JSON + ì—ì…‹ë¸”ë¡ë“¤
.risup:  file â†’ RPack â†’ fflate â†’ MsgPack â†’ AESë³µí˜¸í™” â†’ MsgPack â†’ Preset
.risupreset: file â†’ fflate â†’ MsgPack â†’ AESë³µí˜¸í™” â†’ MsgPack â†’ Preset
.png:    file â†’ tEXtì²­í¬ íŒŒì‹± â†’ Base64 â†’ JSON
```

#### ì•”í˜¸í™” í‚¤ (risup/risupreset)

```typescript
const PRESET_SECRET = 'risupreset';  // í•˜ë“œì½”ë”©
// IV: 12ë°”ì´íŠ¸ 0 ê³ ì •
// ì•Œê³ ë¦¬ì¦˜: AES-GCM (Web Crypto API)
```

### 5.2 í¸ì§‘ ê¸°ëŠ¥ (ëª¨ë“ˆ ë§¤ë‹ˆì € ê¸°ëŠ¥ í†µí•©)

| ê¸°ëŠ¥ | ì„¤ëª… | ìš°ì„ ìˆœìœ„ |
|------|------|:--------:|
| ê¸°ë³¸ ì •ë³´ í¸ì§‘ | ì´ë¦„, ì„¤ëª…, ì„±ê²©, ì‹œë‚˜ë¦¬ì˜¤ | P0 |
| ë¡œì–´ë¶ CRUD | ì¶”ê°€/ìˆ˜ì •/ì‚­ì œ/ê²€ìƒ‰/ì •ë ¬/í´ë”ë§ | P0 |
| Regex í¸ì§‘ | IN/OUT/íƒ€ì…/í”Œë˜ê·¸, CBS í•˜ì´ë¼ì´íŠ¸ | P0 |
| Trigger í¸ì§‘ | V2 êµ¬ì¡°/Lua ì½”ë“œ, ì¡°ê±´/íš¨ê³¼ í¸ì§‘ | P0 |
| ì—ì…‹ ê´€ë¦¬ | ê°¤ëŸ¬ë¦¬ ë·°, ì—…ë¡œë“œ, ì‚­ì œ, í´ë”ë§ | P1 |
| í”„ë¡¬í”„íŠ¸ í…œí”Œë¦¿ | í”„ë¦¬ì…‹ ì „ìš©, CBS í•˜ì´ë¼ì´íŠ¸ | P1 |
| ì „ì²´ ê²€ìƒ‰ | ëª¨ë“  í•„ë“œì—ì„œ í…ìŠ¤íŠ¸ ê²€ìƒ‰ | P1 |
| ì¼ê´„ ì¹˜í™˜ | Find & Replace | P2 |
| ë°±ì—…/ë³µì› | íŒŒì¼ ë²„ì „ ê´€ë¦¬ | P2 |

### 5.3 ì™¸ë¶€ ì—°ë™

| ê¸°ëŠ¥ | ì„¤ëª… | ìš°ì„ ìˆœìœ„ |
|------|------|:--------:|
| Copy for AI | ì»¨í…ìŠ¤íŠ¸ + ë ˆí¼ëŸ°ìŠ¤ + ìš”ì²­ ì¡°í•© | P1 |
| VS Code ë‚´ë³´ë‚´ê¸° | .cbs íŒŒì¼ + ë¶„ì„ | P2 |

---

## 6. ê°œë°œ ë¡œë“œë§µ

> **ìƒì„¸ ì²´í¬ë¦¬ìŠ¤íŠ¸ëŠ” [RisuStudio_Progress.md](RisuStudio_Progress.md)ì—ì„œ í™•ì¸í•˜ì„¸ìš”.**

### Phase 1: í•µì‹¬ ê¸°ë°˜ âœ…

```
Core Layer:
âœ… RPack ì½”ë± (256ë°”ì´íŠ¸ í…Œì´ë¸” ë§¤í•‘)
âœ… BinaryReader/Writer
âœ… AES-GCM ì•”í˜¸í™”/ë³µí˜¸í™” (crypto.ts)
âœ… characterCardParser - fflate unzip, card.json íŒŒì‹±
âœ… risumParser - RPack + ë°”ì´ë„ˆë¦¬ íŒŒì‹±
âœ… risupParser - RPack â†’ fflate â†’ MsgPack â†’ AES (í’€ì²´ì¸)

UI:
âœ… í”„ë¡œì íŠ¸ ì„¤ì • (Svelte + Vite + TypeScript)
âœ… ë©”ì¸ ë„¤ë¹„ê²Œì´ì…˜ (íƒ­ ì „í™˜)
âœ… íŒŒì¼ ë¡œë” (ë“œë˜ê·¸ì•¤ë“œë¡­)
```

### Phase 2: í¸ì§‘ê¸° âœ…

```
UI:
âœ… í¸ì§‘ í™”ë©´ í”„ë ˆì„ (ëª¨ë“ˆë§¤ë‹ˆì € ìŠ¤íƒ€ì¼)
âœ… íƒ­ UI (ì •ë³´/ë¡œì–´ë¶/Regex/Trigger/ì—ì…‹)
âœ… ë¶ë§ˆí¬ íŒ¨ë„ (í•­ëª© ëª©ë¡, ê²€ìƒ‰, í´ë”)
âœ… CodeMirror 6 í†µí•© + CBS í•˜ì´ë¼ì´íŠ¸
âœ… ìë™ì™„ì„± ({{, <, :: íŠ¸ë¦¬ê±°)

Feature:
âœ… EditorService - CRUD ì‘ì—…
âœ… íŒŒì¼ ì €ì¥/ë‹¤ìš´ë¡œë“œ
```

### Phase 3: ì™„ì„±ë„ (ì§„í–‰ ì¤‘)

```
â˜ NAI/ST í”„ë¦¬ì…‹ ë³€í™˜ ì„í¬íŠ¸
â˜ ì‹¤ì‹œê°„ ê²€ì¦ UI
â˜ PWA ì„¤ì •
âœ… GitHub Pages ë°°í¬
```

---

## 7. ì˜ì¡´ì„± ì •ë¦¬

### í•„ìˆ˜ íŒ¨í‚¤ì§€

| íŒ¨í‚¤ì§€ | ìš©ë„ | í¬ê¸° |
|--------|------|------|
| **fflate** | ZIP (.charx), DEFLATE (.risup) | ~13KB |
| **msgpackr** | MsgPack (.risup/.risupreset) | ~15KB |
| **@codemirror/*** | ì½”ë“œ ì—ë””í„° | ~150KB |

### ìˆœìˆ˜ JS êµ¬í˜„ (ì˜ì¡´ì„± ì—†ìŒ)

- RPack ì½”ë± (256ë°”ì´íŠ¸ í…Œì´ë¸”)
- AES-GCM (Web Crypto API)
- BinaryReader/Writer
- PNG tEXt íŒŒì‹±
- ìŠ¤í…Œê°€ë…¸ê·¸ë˜í”¼ ì¶”ì¶œ

---

## 8. í…ŒìŠ¤íŠ¸

### 8.1 í…ŒìŠ¤íŠ¸ ì „ëµ ê°œìš”

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                          í…ŒìŠ¤íŠ¸ ê³„ì¸µ êµ¬ì¡°                                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚  1ï¸âƒ£ íŒŒì„œ í…ŒìŠ¤íŠ¸ (ìŠ¤í‚¤ë§ˆ ë³€ê²½ ê°ì§€)                                          â”‚
â”‚     â€¢ .charx/.risum/.risup íŒŒì‹± â†’ ìŠ¤ëƒ…ìƒ· ë¹„êµ                               â”‚
â”‚     â€¢ AI ì´ë¯¸ì§€ ë©”íƒ€ë°ì´í„° ì¶”ì¶œ â†’ ìŠ¤ëƒ…ìƒ· ë¹„êµ                                â”‚
â”‚     â€¢ RisuAI ì—…ë°ì´íŠ¸ ì‹œ ìŠ¤í‚¤ë§ˆ ë³€ê²½ ìë™ ê°ì§€                               â”‚
â”‚                                                                             â”‚
â”‚  2ï¸âƒ£ ìœ íš¨ì„± ê²€ì¦ (í¸ì§‘ ê²°ê³¼ë¬¼)                                               â”‚
â”‚     â€¢ í¸ì§‘ëœ ìºë¦­í„°/ëª¨ë“ˆ/í”„ë¦¬ì…‹ì´ RisuAIì—ì„œ ë¡œë“œ ê°€ëŠ¥í•œì§€                    â”‚
â”‚     â€¢ í•„ìˆ˜ í•„ë“œ ì¡´ì¬, íƒ€ì… ê²€ì¦, ì¤‘ë³µ ID ê²€ì‚¬                                â”‚
â”‚     â€¢ ì €ì¥ ì „ ì‹¤ì‹œê°„ ê²€ì¦ + ì €ì¥ ì‹œ ìµœì¢… ê²€ì¦                                â”‚
â”‚                                                                             â”‚
â”‚  3ï¸âƒ£ í†µí•© í…ŒìŠ¤íŠ¸ (E2E)                                                       â”‚
â”‚     â€¢ íŒŒì¼ ë¡œë“œ â†’ í¸ì§‘ â†’ ì €ì¥ â†’ ì¬ë¡œë“œ ì™•ë³µ                                  â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 8.2 í˜„ì¬ í…ŒìŠ¤íŠ¸ í˜„í™© (145ê°œ í†µê³¼ âœ…)

- Binary í…ŒìŠ¤íŠ¸: 16ê°œ
- Risum í…ŒìŠ¤íŠ¸: 6ê°œ
- Crypto í…ŒìŠ¤íŠ¸: 7ê°œ
- RPack í…ŒìŠ¤íŠ¸: 5ê°œ
- Validation í…ŒìŠ¤íŠ¸: 31ê°œ
- Schema í…ŒìŠ¤íŠ¸: 41ê°œ
- Parser Snapshot í…ŒìŠ¤íŠ¸: 15ê°œ
- EXIF í…ŒìŠ¤íŠ¸: 24ê°œ

---

## 9. í”„ë¡œì íŠ¸ êµ¬ì¡°

```
risustudio/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ lib/
â”‚   â”‚   â”œâ”€â”€ core/                  # Core Layer
â”‚   â”‚   â”‚   â”œâ”€â”€ formats/           # íŒŒì¼ í¬ë§· (RisuAI_Format_Specification.md ì°¸ì¡°)
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ rpack.ts       # RPack ì½”ë±
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ crypto.ts      # AES-GCM
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ binary.ts      # BinaryReader/Writer
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ charx.ts       # .charx íŒŒì„œ
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ risum.ts       # .risum íŒŒì„œ
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ risup.ts       # .risup íŒŒì„œ
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ png.ts         # PNG tEXt íŒŒì„œ
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ converter.ts   # NAI/ST í”„ë¦¬ì…‹ ë³€í™˜
â”‚   â”‚   â”‚   â”œâ”€â”€ validation/        # ìœ íš¨ì„± ê²€ì¦
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ character.ts
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ module.ts
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ preset.ts
â”‚   â”‚   â”‚   â””â”€â”€ types/
â”‚   â”‚   â”‚       â”œâ”€â”€ character.ts
â”‚   â”‚   â”‚       â”œâ”€â”€ module.ts
â”‚   â”‚   â”‚       â””â”€â”€ preset.ts
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ services/              # Feature Layer
â”‚   â”‚   â”‚   â””â”€â”€ editor.ts
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ stores/                # Shared State
â”‚   â”‚   â”‚   â”œâ”€â”€ files.ts
â”‚   â”‚   â”‚   â””â”€â”€ settings.ts
â”‚   â”‚   â”‚
â”‚   â”‚   â””â”€â”€ components/            # UI Components
â”‚   â”‚       â”œâ”€â”€ common/
â”‚   â”‚       â”‚   â”œâ”€â”€ CodeEditor.svelte
â”‚   â”‚       â”‚   â”œâ”€â”€ Tabs.svelte
â”‚   â”‚       â”‚   â”œâ”€â”€ BookmarkPanel.svelte
â”‚   â”‚       â”‚   â””â”€â”€ Modal.svelte
â”‚   â”‚       â”œâ”€â”€ editor/
â”‚   â”‚       â”‚   â”œâ”€â”€ EditorScreen.svelte
â”‚   â”‚       â”‚   â”œâ”€â”€ InfoTab.svelte
â”‚   â”‚       â”‚   â”œâ”€â”€ LorebookTab.svelte
â”‚   â”‚       â”‚   â””â”€â”€ RegexTab.svelte
â”‚   â”‚       â””â”€â”€ settings/
â”‚   â”‚           â””â”€â”€ SettingsScreen.svelte
â”‚   â”‚
â”‚   â”œâ”€â”€ routes/
â”‚   â”‚   â””â”€â”€ +page.svelte           # ë©”ì¸ í˜ì´ì§€
â”‚   â”‚
â”‚   â”œâ”€â”€ app.html
â”‚   â””â”€â”€ app.css
â”‚
â”œâ”€â”€ static/
â”‚   â””â”€â”€ icons/
â”‚
â”œâ”€â”€ package.json
â”œâ”€â”€ svelte.config.js
â”œâ”€â”€ vite.config.ts
â””â”€â”€ tsconfig.json
```

---

## 10. ìŠ¤íƒ€ì¼ ê°€ì´ë“œ

### 10.1 CSS ë³€ìˆ˜

```css
:root {
  /* ëª¨ë“ˆë§¤ë‹ˆì € í…Œë§ˆ ìƒì† */
  --rs-bg: var(--risu-theme-bgcolor, #1a1a1a);
  --rs-bg-dark: var(--risu-theme-darkbg, #252525);
  --rs-border: var(--risu-theme-borderc, #444);
  --rs-text: var(--risu-theme-textcolor, #fff);
  --rs-text2: var(--risu-theme-textcolor2, #888);
  --rs-primary: var(--risu-theme-primary-600, #4682B4);
  --rs-selected: var(--risu-theme-selected, #333);
  
  /* ìƒíƒœ ìƒ‰ìƒ */
  --rs-success: #27ae60;
  --rs-error: #e74c3c;
  --rs-warning: #f39c12;
}
```

### 10.2 ì»´í¬ë„ŒíŠ¸ ë„¤ì´ë°

```
.rs-*         RisuStudio ê³µí†µ
.rs-editor-*  í¸ì§‘ê¸° ê´€ë ¨
```

---

## 10. ê²°ë¡ 

RisuStudioëŠ” **RisuAI ìºë¦­í„°/ëª¨ë“ˆ/í”„ë¦¬ì…‹ í¸ì§‘ê¸°**ì…ë‹ˆë‹¤.

### í•µì‹¬ ê¸°ëŠ¥

| ê¸°ëŠ¥ | ì„¤ëª… |
|------|------|
| **íŒŒì¼ ì™„ì „ ì§€ì›** | .charx/.risum/.risup ì½ê¸°/ì“°ê¸° |
| **CBS í•˜ì´ë¼ì´íŠ¸** | CodeMirror 6 ê¸°ë°˜ êµ¬ë¬¸ ê°•ì¡° + ìë™ì™„ì„± | readme í¬ë ˆë”§ ì°¸ì¡°
| **ìœ íš¨ì„± ê²€ì¦** | í¸ì§‘ ê²°ê³¼ë¬¼ì´ RisuAIì—ì„œ ë¡œë“œ ê°€ëŠ¥í•œì§€ ì‹¤ì‹œê°„ ê²€ì¦ | readme í¬ë ˆë”§ ì°¸ì¡°
| **ìŠ¤ëƒ…ìƒ· í…ŒìŠ¤íŠ¸** | RisuAI ìŠ¤í‚¤ë§ˆ ë³€ê²½ ìë™ ê°ì§€ |
| **ì›¹ ê¸°ë°˜** | ì„¤ì¹˜ ì—†ì´ GitHub Pagesì—ì„œ ë°”ë¡œ ì‚¬ìš© |
